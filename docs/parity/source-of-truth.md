# MergeSafe parity audit: source of truth

This file is generated by `scripts/parity-audit.mjs`.

## Captured CLI help: `mergesafe --help`

```text
MergeSafe CLI

Usage:
  mergesafe scan <path> [options]
  mergesafe --list-engines
  mergesafe --help

Commands:
  scan             Scan a project path and write outputs
  --list-engines   List available engines and versions

Run `mergesafe scan --help` for scan options.
```

## Captured CLI help: `mergesafe scan --help`

```text
MergeSafe scan

Usage:
  mergesafe scan <path> [options]

Options:
  --out-dir <dir>                Output directory (default: mergesafe)
  --format <csv>                 Output formats (default: json,html,sarif,md)
  --mode <standard|fast>         Scan mode (default: standard)
  --timeout <seconds>            Per-engine timeout seconds (default: 30)
  --concurrency <n>              Engine concurrency (default: 4)
  --fail-on <critical|high|none> Fail threshold (default: high)
  --fail-on-scan-status <none|partial|failed|any> Fail on incomplete scan status (default: none)
  --config <path>                Optional YAML config path
  --engines <list|all>           Comma/space-separated engines list or all available engines
  --auto-install <true|false>    Auto-install missing tools (default: true)
  --no-auto-install              Disable tool auto-install
  --redact                       Redact sensitive fields in output
  --no-cisco                     Remove Cisco engine from selected engines
  --path-mode <relative|absolute> Output path mode for findings (default: relative)
  --verify-downloads <off|warn|strict> Verify downloaded tool checksums (default: warn)
  --max-file-bytes <number>      Max file size for deterministic rules scan (default: 1048576)
```

## Defaults (from CLI help)

| Option | Default |
| --- | --- |
| out-dir | mergesafe |
| format | json,html,sarif,md |
| mode | standard |
| timeout | 30 |
| concurrency | 4 |
| fail-on | high |
| fail-on-scan-status | none |
| auto-install | true |
| path-mode | relative |
| verify-downloads | warn |
| max-file-bytes | 1048576 |

## Engine constants (from built core)

- DEFAULT_ENGINES: mergesafe, semgrep, gitleaks, cisco, osv
- AVAILABLE_ENGINES: mergesafe, semgrep, gitleaks, cisco, osv, trivy

## Action.yml defaults

| Input | Default |
| --- | --- |
| engines |  |
| mode | standard |
| out-dir | mergesafe |
| fail-on | high |
| verify-downloads | strict |

## Docs claim hits

- docs/workflows/mergesafe.yml:25 — mode: standard
- packages/action/action.yml:2 — description: 'Run MergeSafe scanner locally in the workflow runner with default engines (mergesafe, semgrep, gitleaks, cisco, osv) or a custom engines list. Missing tools may be downloaded when auto-install is enabled.'
- packages/action/action.yml:9 — description: 'Scan mode (standard or fast)'
- packages/action/action.yml:11 — default: 'standard'
- packages/action/action.yml:86 — --fail-on "${{ inputs.fail_on }}" \
- packages/action/action.yml:89 — --verify-downloads "${{ inputs.verify_downloads }}" \
- README.md:29 — mergesafe scan fixtures/node-unsafe-server --out-dir mergesafe-test --format json,sarif,md,html --fail-on none
- README.md:38 — Default engines are `mergesafe,semgrep,gitleaks,cisco,osv`. Optional supported engines (for example `trivy`) are **not** included unless you pass them via `--engines`. Missing engine binaries are auto-installed by default into `${HOME}/.mergesafe/tools` (override with `MERGESAFE_TOOLS_DIR`). Auto-install may download tools unless disabled with `--no-auto-install` or `--auto-install false`.
- README.md:52 — - `--mode standard|fast` default `standard`
- README.md:55 — - `--fail-on critical|high|none` default `high`
- README.md:56 — - `--fail-on-scan-status <none|partial|failed|any>` default `none` (separate scan completeness enforcement)
- README.md:59 — - `--auto-install <true|false>` default `true`
- README.md:60 — - `--no-auto-install` disable tool bootstrap
- README.md:62 — - `--verify-downloads <off|warn|strict>` default `warn` in CLI (`strict` in GitHub Action)
- README.md:70 — mode: standard
- README.md:97 — - `gateStatus`: `PASS | FAIL` (did findings violate `--fail-on` policy?)
- README.md:105 — Backward-compatible default behavior is unchanged because `--fail-on-scan-status` defaults to `none`.
- README.md:113 — | Scan-status enforcement triggered by `--fail-on-scan-status` | `3` |
- README.md:119 — - `--fail-on high`, findings include high severity, and scan is PARTIAL → exit `2`.
- README.md:120 — - `--fail-on none --fail-on-scan-status partial`, scan is PARTIAL → exit `3`.
- README.md:121 — - `--fail-on none --fail-on-scan-status failed`, scan is PARTIAL → exit `0`.
- README.md:126 — pnpm -C packages/cli dev -- scan fixtures/node-unsafe-server --out-dir mergesafe-test --fail-on none
- README.md:141 — - On each run, cached binaries are verified against the manifest checksum before execution (unless `--verify-downloads off`).
- README.md:152 — - If `--no-auto-install` is set, missing engines are marked as `skipped` with install hints in `report.json`.
- README.md:159 — - Code is scanned locally and not uploaded by default, but tool bootstrap may download engine binaries unless auto-install is disabled.

## Potential mismatches (heuristic)

- fast-default-claim: A claim suggests fast is default, but CLI help reports mode default as standard.

