<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>MergeSafe Report</title>
  <style>
    body{font-family:Arial,sans-serif;margin:20px}
    table{border-collapse:collapse;width:100%}
    td,th{border:1px solid #ccc;padding:8px;text-align:left;vertical-align:top}
    .badge{padding:4px 8px;border-radius:4px;background:#222;color:#fff}
    .engine-badge{display:inline-block;padding:2px 6px;margin:2px;border-radius:10px;background:#eef;color:#113;font-size:12px}
    .badges{margin-top:4px}
    .found-by{margin-top:6px;font-size:12px;color:#333}
    .found-by-label{font-weight:700}
    .confirm-badge{display:inline-block;margin-left:8px;padding:2px 6px;border-radius:10px;background:#e8fff0;color:#0a5d2a;border:1px solid #b9f2cf;font-weight:700}
    .callout{margin:12px 0;padding:10px 12px;border:1px solid #cfd8ff;background:#f6f8ff;border-radius:8px}
    code{background:#f4f4f4;padding:2px 4px;border-radius:4px}
    pre{white-space:pre-wrap;word-break:break-word;background:#f7f7f7;padding:8px;border-radius:6px;border:1px solid #ddd}

    /* Header pills */
    .meta{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0 14px}
    .pill{border:1px solid #ddd;border-radius:12px;padding:10px 12px;background:#fafafa;min-width:220px}
    .pill .k{display:block;font-size:12px;color:#555;font-weight:700;margin-bottom:4px}
    .pill .v{display:block;font-size:16px;font-weight:800}
    .pill .sub{margin-top:6px;font-size:12px;color:#333}
  </style>
</head>
<body>
  <h1>MergeSafe Report</h1>

  
    <div class="meta">
      <div class="pill"><span class="k">Scan</span> <span class="v">Completed</span></div>
      <div class="pill">
        <span class="k">Policy gate</span>
        <span class="v">DISABLED</span>
        <div class="sub">failOn=none; failOn=none (policy gate disabled)</div>
      </div>
      <div class="pill"><span class="k">Risk grade</span> <span class="v">F / 0</span></div>
    </div>
  

  <div class="callout">
        <strong>Cisco note:</strong> Cisco runs <em>offline-safe</em> by default. When it runs via <code>known-configs</code>,
        it scans MCP client configs on this machine (Cursor/Windsurf/VS Code, etc.), which may be unrelated to the repo.
        To scan the repo deterministically with Cisco, use static tools JSON (e.g. <code>--cisco-tools tools-list.json</code>).
      </div>

  <h2>Engines</h2>
  <table>
    <thead>
      <tr>
        <th>Engine</th>
        <th>Version</th>
        <th>Status</th>
        <th>Duration (ms)</th>
        <th>Error/Hint</th>
        <th>Artifacts</th>
      </tr>
    </thead>
    <tbody><tr>
        <td>MergeSafe deterministic rules<br><code>mergesafe</code></td>
        <td>builtin</td>
        <td>ok</td>
        <td>36</td>
        <td>Built in - no install required.</td>
        <td>-</td>
      </tr><tr>
        <td>Semgrep (local rules only)<br><code>semgrep</code></td>
        <td>1.151.0</td>
        <td>ok</td>
        <td>6551</td>
        <td>Auto-install semgrep into MergeSafe tools cache or install semgrep manually.</td>
        <td><a href="artifacts/semgrep/results.json">json</a> <a href="artifacts/semgrep/results.sarif">sarif</a></td>
      </tr><tr>
        <td>Gitleaks<br><code>gitleaks</code></td>
        <td>8.30.0</td>
        <td>ok</td>
        <td>1314</td>
        <td>Auto-install gitleaks into MergeSafe tools cache or install gitleaks manually.</td>
        <td><a href="artifacts/gitleaks/results.json">json</a> <a href="artifacts/gitleaks/results.sarif">sarif</a></td>
      </tr><tr>
        <td>Cisco mcp-scanner (offline-safe)<br><code>cisco</code></td>
        <td>unknown</td>
        <td>ok</td>
        <td>3770</td>
        <td>Cisco scanned MCP client config(s) from known locations on this machine (not repo source). Validate relevance to the project. Auto-install cisco-ai-mcp-scanner into MergeSafe tools cache or install it manually (CLI: mcp-scanner).</td>
        <td><a href="artifacts/cisco/results.json">json</a></td>
      </tr><tr>
        <td>OSV-Scanner<br><code>osv</code></td>
        <td>osv-scanner version: 2.3.2
osv-scalibr version: 0.4.1
commit: e2a5d93abd9c85d068755973f014d28d6cec02c1
built at: 2026-01-15T01:08:54Z</td>
        <td>ok</td>
        <td>181</td>
        <td>Auto-install osv-scanner into MergeSafe tools cache or install osv-scanner manually.</td>
        <td>-</td>
      </tr></tbody>
  </table>

  <h2>Findings</h2>
  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Severity</th>
        <th>Title</th>
        <th>Location</th>
        <th>Remediation</th>
      </tr>
    </thead>
    <tbody><tr>
        <td>1</td>
        <td>critical</td>
        <td>
          Command execution from user-controlled input
          <div class="badges"><span class="engine-badge">mergesafe</span> <span class="engine-badge">semgrep</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules, Semgrep (local rules only)
        <span class="confirm-badge">Multi-engine confirmed</span>
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:14</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Avoid shell execution; never pass request-derived data into process execution. Prefer allowlists, safe APIs, and strict input validation.</p>
            <pre>exec(req.query.cmd);</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=critical message=Command execution from user-controlled input</li><li><strong>Semgrep (local rules only)</strong> (<code>semgrep</code>) severity=ERROR message=Potential command execution using user-controlled input (req/args). Avoid passing external input to child_process execution APIs.</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>2</td>
        <td>critical</td>
        <td>
          Dynamic tool registration from untrusted input
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:20</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Disallow dynamic tool registration from untrusted data.</p>
            <pre>Dynamic tool registration from user input detected</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=critical message=Dynamic tool registration from untrusted input</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>3</td>
        <td>critical</td>
        <td>
          Dangerous tool capability: arbitrary command execution exposed
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/tools-list.json:4</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Do not expose arbitrary command execution tools to untrusted callers. Remove shell execution, enforce strict allowlists, require strong auth + approvals, and sandbox execution.</p>
            <pre>exec_system_command: Runs an arbitrary system command on the host machine. Intended for advanced admin automation. WARNING: can execute any shell command. | schema props=[command, cwd, timeoutMs] required=[command]</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=critical message=Dangerous tool capability: arbitrary command execution exposed</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>4</td>
        <td>high</td>
        <td>
          Destructive tools exposed without gating hints
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:8</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Require explicit authorization/gating hints.</p>
            <pre>destructive pattern</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Destructive tools exposed without gating hints</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>5</td>
        <td>high</td>
        <td>
          Missing auth middleware smell on HTTP MCP endpoints
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:12</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Add auth middleware to MCP endpoints.</p>
            <pre>Endpoint appears unauthenticated</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Missing auth middleware smell on HTTP MCP endpoints</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>6</td>
        <td>high</td>
        <td>
          Secrets or tokens likely logged or dumped
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:13</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Redact secrets before logging.</p>
            <pre>Sensitive value appears in logs</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Secrets or tokens likely logged or dumped</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>7</td>
        <td>high</td>
        <td>
          Filesystem write with user-controlled path
          <div class="badges"><span class="engine-badge">mergesafe</span> <span class="engine-badge">semgrep</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules, Semgrep (local rules only)
        <span class="confirm-badge">Multi-engine confirmed</span>
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:15</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Use path normalization and allowlisted directories. Never write to arbitrary paths derived from requests or user input.</p>
            <pre>fs.writeFileSync(req.query.path, req.body.data);</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Filesystem write with user-controlled path</li><li><strong>Semgrep (local rules only)</strong> (<code>semgrep</code>) severity=WARNING message=Potential filesystem write using user-controlled path. Constrain writes to allowlisted directories and normalize paths.</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>8</td>
        <td>high</td>
        <td>
          Network egress from tool handlers without allowlist
          <div class="badges"><span class="engine-badge">mergesafe</span> <span class="engine-badge">semgrep</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules, Semgrep (local rules only)
        <span class="confirm-badge">Multi-engine confirmed</span>
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:16</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Enforce explicit egress allowlist.</p>
            <pre>Outgoing network call in handler without allowlist</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Network egress from tool handlers without allowlist</li><li><strong>Semgrep (local rules only)</strong> (<code>semgrep</code>) severity=WARNING message=Network egress using user-controlled URL. Validate destinations and consider allowlists to prevent SSRF/egress abuse.</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>9</td>
        <td>high</td>
        <td>
          High-risk tool exposed without gating hints (auth/allowlist/approval)
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/tools-list.json:4</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.</p>
            <pre>exec_system_command: Runs an arbitrary system command on the host machine. Intended for advanced admin automation. WARNING: can execute any shell command. | schema props=[command, cwd, timeoutMs] required=[command]</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=High-risk tool exposed without gating hints (auth/allowlist/approval)</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>10</td>
        <td>high</td>
        <td>
          Dangerous tool capability: arbitrary file read without allowlist
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/tools-list.json:18</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Restrict reads to allowlisted directories. Normalize paths, block absolute paths and traversal, enforce auth, and audit access.</p>
            <pre>read_any_file: Reads the contents of any local file path provided by the user (no allowlist). Useful for debugging and support. | schema props=[path, maxBytes] required=[path]</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Dangerous tool capability: arbitrary file read without allowlist</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>11</td>
        <td>high</td>
        <td>
          High-risk tool exposed without gating hints (auth/allowlist/approval)
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/tools-list.json:18</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.</p>
            <pre>read_any_file: Reads the contents of any local file path provided by the user (no allowlist). Useful for debugging and support. | schema props=[path, maxBytes] required=[path]</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=High-risk tool exposed without gating hints (auth/allowlist/approval)</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>12</td>
        <td>high</td>
        <td>
          Dangerous tool capability: unrestricted network egress without allowlist
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/tools-list.json:31</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Enforce egress allowlists (hosts/schemes/ports). Block private/link-local ranges by default. Limit user-controlled headers. Require auth + approvals.</p>
            <pre>http_fetch: Fetches any URL and returns the response body. Supports internal hosts and arbitrary headers. Can be used to call internal services. | schema props=[url, method, headers] required=[url]</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Dangerous tool capability: unrestricted network egress without allowlist</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>13</td>
        <td>high</td>
        <td>
          High-risk tool exposed without gating hints (auth/allowlist/approval)
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/tools-list.json:31</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.</p>
            <pre>http_fetch: Fetches any URL and returns the response body. Supports internal hosts and arbitrary headers. Can be used to call internal services. | schema props=[url, method, headers] required=[url]</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=High-risk tool exposed without gating hints (auth/allowlist/approval)</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>14</td>
        <td>high</td>
        <td>
          Dangerous tool behavior: token/secret logging helper present
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/tools-list.json:49</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Remove secret/token logging tools from production. If needed locally, gate behind build flags, redact outputs, and ensure secrets never reach logs.</p>
            <pre>log_debug_token: Debug helper that prints tokens/keys during troubleshooting. (Should never be enabled in production.) | schema props=[token] required=[token]</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=high message=Dangerous tool behavior: token/secret logging helper present</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>15</td>
        <td>medium</td>
        <td>
          Tool descriptions claim read-only but code suggests writes/egress
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:7</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Align tool metadata with actual capabilities.</p>
            <pre>Read-only claim conflicts with mutating capabilities</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=medium message=Tool descriptions claim read-only but code suggests writes/egress</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>16</td>
        <td>medium</td>
        <td>
          Overly-broad OAuth scope patterns in config
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:9</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Use least-privilege OAuth scopes.</p>
            <pre>Broad OAuth scope detected</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=medium message=Overly-broad OAuth scope patterns in config</li></ul>
          </details>
        </td>
      </tr><tr>
        <td>17</td>
        <td>medium</td>
        <td>
          Unsafe defaults (debug/allow-all)
          <div class="badges"><span class="engine-badge">mergesafe</span></div>
          <div class="found-by">
        <span class="found-by-label">Found by:</span> MergeSafe deterministic rules
        
      </div>
        </td>
        <td>C:/MergeSafe/mergesafe-scanner/fixtures/node-unsafe-server/server.js:10</td>
        <td>
          <details>
            <summary>Details</summary>
            <p>Disable debug and tighten allow-lists.</p>
            <pre>Unsafe permissive defaults found</pre>
            <p>Engine matrix:</p>
            <ul><li><strong>MergeSafe deterministic rules</strong> (<code>mergesafe</code>) severity=medium message=Unsafe defaults (debug/allow-all)</li></ul>
          </details>
        </td>
      </tr></tbody>
  </table>
</body>
</html>