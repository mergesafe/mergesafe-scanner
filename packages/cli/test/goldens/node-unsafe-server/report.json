{
  "meta": {
    "scannedPath": "../../fixtures/node-unsafe-server",
    "generatedAt": "2026-02-13T20:43:02.044Z",
    "mode": "fast",
    "timeout": 30,
    "concurrency": 4,
    "redacted": false,
    "engines": [
      {
        "engineId": "mergesafe",
        "displayName": "MergeSafe deterministic rules",
        "version": "builtin",
        "status": "ok",
        "durationMs": 22,
        "installHint": "Built in - no install required."
      }
    ]
  },
  "summary": {
    "totalFindings": 17,
    "bySeverity": {
      "critical": 3,
      "high": 11,
      "medium": 3,
      "low": 0,
      "info": 0
    },
    "score": 0,
    "grade": "F",
    "scanStatus": "COMPLETED",
    "gate": {
      "status": "PASS",
      "failOn": "none",
      "reason": "failOn=none (policy gate disabled)"
    },
    "status": "PASS"
  },
  "findings": [
    {
      "findingId": "ms-31055677bb5bd72c",
      "title": "Command execution from user-controlled input",
      "severity": "critical",
      "confidence": "medium",
      "category": "injection",
      "owaspMcpTop10": "MCP-A03",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS002",
          "engineSeverity": "critical",
          "message": "Command execution from user-controlled input"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 14
        }
      ],
      "evidence": {
        "excerpt": "exec(req.query.cmd);",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Avoid shell execution; never pass request-derived data into process execution. Prefer allowlists, safe APIs, and strict input validation.",
      "references": [],
      "tags": [
        "exec",
        "taint"
      ],
      "fingerprint": "31055677bb5bd72c"
    },
    {
      "findingId": "ms-b6a962733aacb1f3",
      "title": "Dangerous tool capability: arbitrary command execution exposed",
      "severity": "critical",
      "confidence": "medium",
      "category": "injection",
      "owaspMcpTop10": "MCP-A03",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS012",
          "engineSeverity": "critical",
          "message": "Dangerous tool capability: arbitrary command execution exposed"
        }
      ],
      "locations": [
        {
          "filePath": "tools-list.json",
          "line": 4
        }
      ],
      "evidence": {
        "excerpt": "exec_system_command: Runs an arbitrary system command on the host machine. Intended for advanced admin automation. WARNING: can execute any shell command. | schema props=[command, cwd, timeoutMs] required=[command]",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Do not expose arbitrary command execution tools to untrusted callers. Remove shell execution, enforce strict allowlists, require strong auth + approvals, and sandbox execution.",
      "references": [],
      "tags": [
        "exec",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "b6a962733aacb1f3"
    },
    {
      "findingId": "ms-32dcd0e16deae65e",
      "title": "Dynamic tool registration from untrusted input",
      "severity": "critical",
      "confidence": "medium",
      "category": "integrity",
      "owaspMcpTop10": "MCP-A10",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS010",
          "engineSeverity": "critical",
          "message": "Dynamic tool registration from untrusted input"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 20
        }
      ],
      "evidence": {
        "excerpt": "Dynamic tool registration from user input detected",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Disallow dynamic tool registration from untrusted data.",
      "references": [],
      "tags": [
        "dynamic-tools"
      ],
      "fingerprint": "32dcd0e16deae65e"
    },
    {
      "findingId": "ms-c1e41f5fe8e2c434",
      "title": "Destructive tools exposed without gating hints",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS001",
          "engineSeverity": "high",
          "message": "Destructive tools exposed without gating hints"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 8
        }
      ],
      "evidence": {
        "excerpt": "destructive pattern",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Require explicit authorization/gating hints.",
      "references": [],
      "tags": [
        "destructive",
        "gating",
        "gating-missing"
      ],
      "fingerprint": "c1e41f5fe8e2c434"
    },
    {
      "findingId": "ms-bbe867373bae3191",
      "title": "Missing auth middleware smell on HTTP MCP endpoints",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS007",
          "engineSeverity": "high",
          "message": "Missing auth middleware smell on HTTP MCP endpoints"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 12
        }
      ],
      "evidence": {
        "excerpt": "Endpoint appears unauthenticated",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Add auth middleware to MCP endpoints.",
      "references": [],
      "tags": [
        "auth"
      ],
      "fingerprint": "bbe867373bae3191"
    },
    {
      "findingId": "ms-90c4f520eadd96bb",
      "title": "High-risk tool exposed without gating hints (auth/allowlist/approval)",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS016",
          "engineSeverity": "high",
          "message": "High-risk tool exposed without gating hints (auth/allowlist/approval)"
        }
      ],
      "locations": [
        {
          "filePath": "tools-list.json",
          "line": 4
        }
      ],
      "evidence": {
        "excerpt": "exec_system_command: Runs an arbitrary system command on the host machine. Intended for advanced admin automation. WARNING: can execute any shell command. | schema props=[command, cwd, timeoutMs] required=[command]",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.",
      "references": [],
      "tags": [
        "gating",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "90c4f520eadd96bb"
    },
    {
      "findingId": "ms-2bf62b2b00f37456",
      "title": "High-risk tool exposed without gating hints (auth/allowlist/approval)",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS016",
          "engineSeverity": "high",
          "message": "High-risk tool exposed without gating hints (auth/allowlist/approval)"
        }
      ],
      "locations": [
        {
          "filePath": "tools-list.json",
          "line": 18
        }
      ],
      "evidence": {
        "excerpt": "read_any_file: Reads the contents of any local file path provided by the user (no allowlist). Useful for debugging and support. | schema props=[path, maxBytes] required=[path]",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.",
      "references": [],
      "tags": [
        "gating",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "2bf62b2b00f37456"
    },
    {
      "findingId": "ms-065f0bddaf56dcef",
      "title": "High-risk tool exposed without gating hints (auth/allowlist/approval)",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS016",
          "engineSeverity": "high",
          "message": "High-risk tool exposed without gating hints (auth/allowlist/approval)"
        }
      ],
      "locations": [
        {
          "filePath": "tools-list.json",
          "line": 31
        }
      ],
      "evidence": {
        "excerpt": "http_fetch: Fetches any URL and returns the response body. Supports internal hosts and arbitrary headers. Can be used to call internal services. | schema props=[url, method, headers] required=[url]",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.",
      "references": [],
      "tags": [
        "gating",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "065f0bddaf56dcef"
    },
    {
      "findingId": "ms-333ca87956598cb9",
      "title": "Filesystem write with user-controlled path",
      "severity": "high",
      "confidence": "medium",
      "category": "filesystem",
      "owaspMcpTop10": "MCP-A04",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS003",
          "engineSeverity": "high",
          "message": "Filesystem write with user-controlled path"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 15
        }
      ],
      "evidence": {
        "excerpt": "fs.writeFileSync(req.query.path, req.body.data);",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Use path normalization and allowlisted directories. Never write to arbitrary paths derived from requests or user input.",
      "references": [],
      "tags": [
        "fs-write",
        "path-traversal",
        "taint"
      ],
      "fingerprint": "333ca87956598cb9"
    },
    {
      "findingId": "ms-09a517c58dd95a01",
      "title": "Dangerous tool capability: arbitrary file read without allowlist",
      "severity": "high",
      "confidence": "medium",
      "category": "filesystem",
      "owaspMcpTop10": "MCP-A04",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS013",
          "engineSeverity": "high",
          "message": "Dangerous tool capability: arbitrary file read without allowlist"
        }
      ],
      "locations": [
        {
          "filePath": "tools-list.json",
          "line": 18
        }
      ],
      "evidence": {
        "excerpt": "read_any_file: Reads the contents of any local file path provided by the user (no allowlist). Useful for debugging and support. | schema props=[path, maxBytes] required=[path]",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Restrict reads to allowlisted directories. Normalize paths, block absolute paths and traversal, enforce auth, and audit access.",
      "references": [],
      "tags": [
        "fs-read",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "09a517c58dd95a01"
    },
    {
      "findingId": "ms-d26ea197d0dd55c5",
      "title": "Network egress from tool handlers without allowlist",
      "severity": "high",
      "confidence": "medium",
      "category": "network",
      "owaspMcpTop10": "MCP-A06",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS004",
          "engineSeverity": "high",
          "message": "Network egress from tool handlers without allowlist"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 16
        }
      ],
      "evidence": {
        "excerpt": "Outgoing network call in handler without allowlist",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Enforce explicit egress allowlist.",
      "references": [],
      "tags": [
        "gating-missing",
        "net-egress"
      ],
      "fingerprint": "d26ea197d0dd55c5"
    },
    {
      "findingId": "ms-3975848c2c8ad209",
      "title": "Dangerous tool capability: unrestricted network egress without allowlist",
      "severity": "high",
      "confidence": "medium",
      "category": "network",
      "owaspMcpTop10": "MCP-A06",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS014",
          "engineSeverity": "high",
          "message": "Dangerous tool capability: unrestricted network egress without allowlist"
        }
      ],
      "locations": [
        {
          "filePath": "tools-list.json",
          "line": 31
        }
      ],
      "evidence": {
        "excerpt": "http_fetch: Fetches any URL and returns the response body. Supports internal hosts and arbitrary headers. Can be used to call internal services. | schema props=[url, method, headers] required=[url]",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Enforce egress allowlists (hosts/schemes/ports). Block private/link-local ranges by default. Limit user-controlled headers. Require auth + approvals.",
      "references": [],
      "tags": [
        "gating-missing",
        "net-egress",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "3975848c2c8ad209"
    },
    {
      "findingId": "ms-d2e7c54a396a643c",
      "title": "Secrets or tokens likely logged or dumped",
      "severity": "high",
      "confidence": "medium",
      "category": "secrets",
      "owaspMcpTop10": "MCP-A02",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS005",
          "engineSeverity": "high",
          "message": "Secrets or tokens likely logged or dumped"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 13
        }
      ],
      "evidence": {
        "excerpt": "Sensitive value appears in logs",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Redact secrets before logging.",
      "references": [],
      "tags": [
        "secrets"
      ],
      "fingerprint": "d2e7c54a396a643c"
    },
    {
      "findingId": "ms-428255fe13e67a3a",
      "title": "Dangerous tool behavior: token/secret logging helper present",
      "severity": "high",
      "confidence": "medium",
      "category": "secrets",
      "owaspMcpTop10": "MCP-A02",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS015",
          "engineSeverity": "high",
          "message": "Dangerous tool behavior: token/secret logging helper present"
        }
      ],
      "locations": [
        {
          "filePath": "tools-list.json",
          "line": 49
        }
      ],
      "evidence": {
        "excerpt": "log_debug_token: Debug helper that prints tokens/keys during troubleshooting. (Should never be enabled in production.) | schema props=[token] required=[token]",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Remove secret/token logging tools from production. If needed locally, gate behind build flags, redact outputs, and ensure secrets never reach logs.",
      "references": [],
      "tags": [
        "logging",
        "policy",
        "secrets",
        "tool-manifest"
      ],
      "fingerprint": "428255fe13e67a3a"
    },
    {
      "findingId": "ms-1dd7e517b754b249",
      "title": "Overly-broad OAuth scope patterns in config",
      "severity": "medium",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A07",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS006",
          "engineSeverity": "medium",
          "message": "Overly-broad OAuth scope patterns in config"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 9
        }
      ],
      "evidence": {
        "excerpt": "Broad OAuth scope detected",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Use least-privilege OAuth scopes.",
      "references": [],
      "tags": [
        "oauth"
      ],
      "fingerprint": "1dd7e517b754b249"
    },
    {
      "findingId": "ms-cc9492a27784c1e8",
      "title": "Unsafe defaults (debug/allow-all)",
      "severity": "medium",
      "confidence": "medium",
      "category": "hardening",
      "owaspMcpTop10": "MCP-A08",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS008",
          "engineSeverity": "medium",
          "message": "Unsafe defaults (debug/allow-all)"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 10
        }
      ],
      "evidence": {
        "excerpt": "Unsafe permissive defaults found",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Disable debug and tighten allow-lists.",
      "references": [],
      "tags": [
        "defaults"
      ],
      "fingerprint": "cc9492a27784c1e8"
    },
    {
      "findingId": "ms-99f5d4f0665c1286",
      "title": "Tool descriptions claim read-only but code suggests writes/egress",
      "severity": "medium",
      "confidence": "medium",
      "category": "integrity",
      "owaspMcpTop10": "MCP-A09",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS009",
          "engineSeverity": "medium",
          "message": "Tool descriptions claim read-only but code suggests writes/egress"
        }
      ],
      "locations": [
        {
          "filePath": "server.js",
          "line": 7
        }
      ],
      "evidence": {
        "excerpt": "Read-only claim conflicts with mutating capabilities",
        "note": "Merged evidence (best available excerpt)"
      },
      "remediation": "Align tool metadata with actual capabilities.",
      "references": [],
      "tags": [
        "tool-metadata"
      ],
      "fingerprint": "99f5d4f0665c1286"
    }
  ],
  "byEngine": {
    "mergesafe": 17
  }
}