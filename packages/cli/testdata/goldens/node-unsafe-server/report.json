{
  "meta": {
    "scannedPath": "fixtures/node-unsafe-server",
    "generatedAt": "2026-02-12T20:59:21.532Z",
    "mode": "fast",
    "timeout": 30,
    "concurrency": 4,
    "redacted": true,
    "engines": [
      {
        "engineId": "mergesafe",
        "displayName": "MergeSafe deterministic rules",
        "version": "builtin",
        "status": "ok",
        "durationMs": 21,
        "installHint": "Built in - no install required."
      }
    ]
  },
  "summary": {
    "totalFindings": 17,
    "bySeverity": {
      "critical": 3,
      "high": 11,
      "medium": 3,
      "low": 0,
      "info": 0
    },
    "score": 0,
    "grade": "F",
    "scanStatus": "COMPLETED",
    "gate": {
      "status": "PASS",
      "failOn": "none",
      "reason": "failOn=none (policy gate disabled)"
    },
    "status": "PASS"
  },
  "findings": [
    {
      "findingId": "ms-31055677bb5bd72c",
      "title": "Command execution from user-controlled input",
      "severity": "critical",
      "confidence": "medium",
      "category": "injection",
      "owaspMcpTop10": "MCP-A03",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS002",
          "engineSeverity": "critical",
          "message": "Command execution from user-controlled input"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 14
        }
      ],
      "evidence": {
        "excerptHash": "3a9810d3fee53516",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Avoid shell execution; never pass request-derived data into process execution. Prefer allowlists, safe APIs, and strict input validation.",
      "references": [],
      "tags": [
        "exec",
        "taint"
      ],
      "fingerprint": "31055677bb5bd72c"
    },
    {
      "findingId": "ms-32dcd0e16deae65e",
      "title": "Dynamic tool registration from untrusted input",
      "severity": "critical",
      "confidence": "medium",
      "category": "integrity",
      "owaspMcpTop10": "MCP-A10",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS010",
          "engineSeverity": "critical",
          "message": "Dynamic tool registration from untrusted input"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 20
        }
      ],
      "evidence": {
        "excerptHash": "f46f9e17661d98bf",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Disallow dynamic tool registration from untrusted data.",
      "references": [],
      "tags": [
        "dynamic-tools"
      ],
      "fingerprint": "32dcd0e16deae65e"
    },
    {
      "findingId": "ms-b6a962733aacb1f3",
      "title": "Dangerous tool capability: arbitrary command execution exposed",
      "severity": "critical",
      "confidence": "medium",
      "category": "injection",
      "owaspMcpTop10": "MCP-A03",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS012",
          "engineSeverity": "critical",
          "message": "Dangerous tool capability: arbitrary command execution exposed"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/tools-list.json",
          "line": 4
        }
      ],
      "evidence": {
        "excerptHash": "4bf15ab189ac2501",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Do not expose arbitrary command execution tools to untrusted callers. Remove shell execution, enforce strict allowlists, require strong auth + approvals, and sandbox execution.",
      "references": [],
      "tags": [
        "exec",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "b6a962733aacb1f3"
    },
    {
      "findingId": "ms-c1e41f5fe8e2c434",
      "title": "Destructive tools exposed without gating hints",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS001",
          "engineSeverity": "high",
          "message": "Destructive tools exposed without gating hints"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 8
        }
      ],
      "evidence": {
        "excerptHash": "ca460dca4eabae2c",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Require explicit authorization/gating hints.",
      "references": [],
      "tags": [
        "destructive",
        "gating",
        "gating-missing"
      ],
      "fingerprint": "c1e41f5fe8e2c434"
    },
    {
      "findingId": "ms-bbe867373bae3191",
      "title": "Missing auth middleware smell on HTTP MCP endpoints",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS007",
          "engineSeverity": "high",
          "message": "Missing auth middleware smell on HTTP MCP endpoints"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 12
        }
      ],
      "evidence": {
        "excerptHash": "52e279ba99d4c8f0",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Add auth middleware to MCP endpoints.",
      "references": [],
      "tags": [
        "auth"
      ],
      "fingerprint": "bbe867373bae3191"
    },
    {
      "findingId": "ms-d2e7c54a396a643c",
      "title": "Secrets or tokens likely logged or dumped",
      "severity": "high",
      "confidence": "medium",
      "category": "secrets",
      "owaspMcpTop10": "MCP-A02",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS005",
          "engineSeverity": "high",
          "message": "Secrets or tokens likely logged or dumped"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 13
        }
      ],
      "evidence": {
        "excerptHash": "a06c752e8a19bb73",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Redact secrets before logging.",
      "references": [],
      "tags": [
        "secrets"
      ],
      "fingerprint": "d2e7c54a396a643c"
    },
    {
      "findingId": "ms-333ca87956598cb9",
      "title": "Filesystem write with user-controlled path",
      "severity": "high",
      "confidence": "medium",
      "category": "filesystem",
      "owaspMcpTop10": "MCP-A04",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS003",
          "engineSeverity": "high",
          "message": "Filesystem write with user-controlled path"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 15
        }
      ],
      "evidence": {
        "excerptHash": "2972f231792b80c8",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Use path normalization and allowlisted directories. Never write to arbitrary paths derived from requests or user input.",
      "references": [],
      "tags": [
        "fs-write",
        "path-traversal",
        "taint"
      ],
      "fingerprint": "333ca87956598cb9"
    },
    {
      "findingId": "ms-d26ea197d0dd55c5",
      "title": "Network egress from tool handlers without allowlist",
      "severity": "high",
      "confidence": "medium",
      "category": "network",
      "owaspMcpTop10": "MCP-A06",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS004",
          "engineSeverity": "high",
          "message": "Network egress from tool handlers without allowlist"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 16
        }
      ],
      "evidence": {
        "excerptHash": "122ccaf721c13825",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Enforce explicit egress allowlist.",
      "references": [],
      "tags": [
        "gating-missing",
        "net-egress"
      ],
      "fingerprint": "d26ea197d0dd55c5"
    },
    {
      "findingId": "ms-90c4f520eadd96bb",
      "title": "High-risk tool exposed without gating hints (auth/allowlist/approval)",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS016",
          "engineSeverity": "high",
          "message": "High-risk tool exposed without gating hints (auth/allowlist/approval)"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/tools-list.json",
          "line": 4
        }
      ],
      "evidence": {
        "excerptHash": "dd9cef9529f56dd6",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.",
      "references": [],
      "tags": [
        "gating",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "90c4f520eadd96bb"
    },
    {
      "findingId": "ms-09a517c58dd95a01",
      "title": "Dangerous tool capability: arbitrary file read without allowlist",
      "severity": "high",
      "confidence": "medium",
      "category": "filesystem",
      "owaspMcpTop10": "MCP-A04",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS013",
          "engineSeverity": "high",
          "message": "Dangerous tool capability: arbitrary file read without allowlist"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/tools-list.json",
          "line": 18
        }
      ],
      "evidence": {
        "excerptHash": "b690e452d25a29b3",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Restrict reads to allowlisted directories. Normalize paths, block absolute paths and traversal, enforce auth, and audit access.",
      "references": [],
      "tags": [
        "fs-read",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "09a517c58dd95a01"
    },
    {
      "findingId": "ms-2bf62b2b00f37456",
      "title": "High-risk tool exposed without gating hints (auth/allowlist/approval)",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS016",
          "engineSeverity": "high",
          "message": "High-risk tool exposed without gating hints (auth/allowlist/approval)"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/tools-list.json",
          "line": 18
        }
      ],
      "evidence": {
        "excerptHash": "dd9cef9529f56dd6",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.",
      "references": [],
      "tags": [
        "gating",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "2bf62b2b00f37456"
    },
    {
      "findingId": "ms-065f0bddaf56dcef",
      "title": "High-risk tool exposed without gating hints (auth/allowlist/approval)",
      "severity": "high",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A01",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS016",
          "engineSeverity": "high",
          "message": "High-risk tool exposed without gating hints (auth/allowlist/approval)"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/tools-list.json",
          "line": 31
        }
      ],
      "evidence": {
        "excerptHash": "dd9cef9529f56dd6",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Add explicit gating: authentication, authorization scopes, approvals/confirmations, and allowlists. Document constraints in tool metadata and enforce them in code.",
      "references": [],
      "tags": [
        "gating",
        "gating-missing",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "065f0bddaf56dcef"
    },
    {
      "findingId": "ms-3975848c2c8ad209",
      "title": "Dangerous tool capability: unrestricted network egress without allowlist",
      "severity": "high",
      "confidence": "medium",
      "category": "network",
      "owaspMcpTop10": "MCP-A06",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS014",
          "engineSeverity": "high",
          "message": "Dangerous tool capability: unrestricted network egress without allowlist"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/tools-list.json",
          "line": 31
        }
      ],
      "evidence": {
        "excerptHash": "e6de166f7980ed26",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Enforce egress allowlists (hosts/schemes/ports). Block private/link-local ranges by default. Limit user-controlled headers. Require auth + approvals.",
      "references": [],
      "tags": [
        "gating-missing",
        "net-egress",
        "policy",
        "tool-manifest"
      ],
      "fingerprint": "3975848c2c8ad209"
    },
    {
      "findingId": "ms-428255fe13e67a3a",
      "title": "Dangerous tool behavior: token/secret logging helper present",
      "severity": "high",
      "confidence": "medium",
      "category": "secrets",
      "owaspMcpTop10": "MCP-A02",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS015",
          "engineSeverity": "high",
          "message": "Dangerous tool behavior: token/secret logging helper present"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/tools-list.json",
          "line": 49
        }
      ],
      "evidence": {
        "excerptHash": "edb01c0be4b8a74d",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Remove secret/token logging tools from production. If needed locally, gate behind build flags, redact outputs, and ensure secrets never reach logs.",
      "references": [],
      "tags": [
        "logging",
        "policy",
        "secrets",
        "tool-manifest"
      ],
      "fingerprint": "428255fe13e67a3a"
    },
    {
      "findingId": "ms-99f5d4f0665c1286",
      "title": "Tool descriptions claim read-only but code suggests writes/egress",
      "severity": "medium",
      "confidence": "medium",
      "category": "integrity",
      "owaspMcpTop10": "MCP-A09",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS009",
          "engineSeverity": "medium",
          "message": "Tool descriptions claim read-only but code suggests writes/egress"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 7
        }
      ],
      "evidence": {
        "excerptHash": "09d100e509ba6822",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Align tool metadata with actual capabilities.",
      "references": [],
      "tags": [
        "tool-metadata"
      ],
      "fingerprint": "99f5d4f0665c1286"
    },
    {
      "findingId": "ms-1dd7e517b754b249",
      "title": "Overly-broad OAuth scope patterns in config",
      "severity": "medium",
      "confidence": "medium",
      "category": "auth",
      "owaspMcpTop10": "MCP-A07",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS006",
          "engineSeverity": "medium",
          "message": "Overly-broad OAuth scope patterns in config"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 9
        }
      ],
      "evidence": {
        "excerptHash": "2bfd57efbed9f5e0",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Use least-privilege OAuth scopes.",
      "references": [],
      "tags": [
        "oauth"
      ],
      "fingerprint": "1dd7e517b754b249"
    },
    {
      "findingId": "ms-cc9492a27784c1e8",
      "title": "Unsafe defaults (debug/allow-all)",
      "severity": "medium",
      "confidence": "medium",
      "category": "hardening",
      "owaspMcpTop10": "MCP-A08",
      "engineSources": [
        {
          "engineId": "mergesafe",
          "engineRuleId": "MS008",
          "engineSeverity": "medium",
          "message": "Unsafe defaults (debug/allow-all)"
        }
      ],
      "locations": [
        {
          "filePath": "fixtures/node-unsafe-server/server.js",
          "line": 10
        }
      ],
      "evidence": {
        "excerptHash": "1bfe45c79fe09c5a",
        "note": "Merged evidence (hash only)"
      },
      "remediation": "Disable debug and tighten allow-lists.",
      "references": [],
      "tags": [
        "defaults"
      ],
      "fingerprint": "cc9492a27784c1e8"
    }
  ],
  "byEngine": {
    "mergesafe": 17
  }
}